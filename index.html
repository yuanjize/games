<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘é¡µæ¸¸æˆåˆé›† - åä¸ªç²¾å½©æ¸¸æˆ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00dbde">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ¸¸æˆåˆé›†">
    <meta name="description" content="åä¸ªç²¾å¿ƒè®¾è®¡çš„ç½‘é¡µæ¸¸æˆï¼Œçº¯åŸç”ŸJavaScriptå®ç°ï¼Œæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡">
    <meta name="keywords" content="ç½‘é¡µæ¸¸æˆ,åœ¨çº¿æ¸¸æˆ,å…è´¹æ¸¸æˆ,HTML5æ¸¸æˆ,JavaScriptæ¸¸æˆ">
    <meta name="author" content="Game Collection">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="ç½‘é¡µæ¸¸æˆåˆé›†">
    <meta property="og:description" content="åä¸ªç²¾å¿ƒè®¾è®¡çš„ç½‘é¡µæ¸¸æˆ">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="shared-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ®</text></svg>">
</head>
<body>
    <!-- PWA å®‰è£…æç¤ºæ¨ªå¹… -->
    <div class="pwa-install-banner" id="pwa-banner">
        <div class="banner-content">
            <div class="banner-icon">ğŸ®</div>
            <div class="banner-text">
                <div class="banner-title">å®‰è£…æ¸¸æˆåˆé›†</div>
                <div class="banner-description">æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œè·å¾—æ›´å¥½çš„ä½“éªŒ</div>
            </div>
            <button class="banner-close" id="banner-close" aria-label="å…³é—­æç¤º">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <button class="banner-install" id="banner-install">
            <i class="fas fa-download"></i> å®‰è£…
        </button>
    </div>

    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-decoration">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
        <div class="floating-shape shape-5"></div>
    </div>

    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="header-text">
                    <h1>ç½‘é¡µæ¸¸æˆåˆé›†</h1>
                    <p class="subtitle">åä¸ªç²¾å¿ƒè®¾è®¡çš„ç½‘é¡µæ¸¸æˆï¼Œçº¯åŸç”ŸJavaScriptå®ç°</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-moon" aria-hidden="true"></i>
                </button>
            </div>
        </header>

        <!-- ç»Ÿè®¡é¢æ¿ -->
        <section class="stats-panel" id="stats-panel">
            <div class="stat-card">
                <div class="stat-icon" style="color: #00dbde;">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-value" id="total-games">10</div>
                    <div class="stat-label">æ¸¸æˆæ€»æ•°</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color: #4cd964;">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-value" id="play-time">0</div>
                    <div class="stat-label">æ¸¸æˆæ—¶é•¿(åˆ†)</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color: #ff6b6b;">
                    <i class="fas fa-heart"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-value" id="games-played">0</div>
                    <div class="stat-label">å·²æ¸¸ç©</div>
                </div>
            </div>
        </section>

        <!-- åˆ†ç±»æ ‡ç­¾ -->
        <section class="category-filter">
            <button class="category-btn active" data-category="all">
                <i class="fas fa-th"></i> å…¨éƒ¨
            </button>
            <button class="category-btn" data-category="action">
                <i class="fas fa-bolt"></i> åŠ¨ä½œ
            </button>
            <button class="category-btn" data-category="puzzle">
                <i class="fas fa-puzzle-piece"></i> ç›Šæ™º
            </button>
            <button class="category-btn" data-category="strategy">
                <i class="fas fa-chess"></i> ç­–ç•¥
            </button>
            <button class="category-btn" data-category="casual">
                <i class="fas fa-coffee"></i> ä¼‘é—²
            </button>
        </section>

        <!-- æœç´¢æ¡† -->
        <section class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="æœç´¢æ¸¸æˆ..." aria-label="æœç´¢æ¸¸æˆ">
            </div>
        </section>

        <!-- æ¸¸æˆç½‘æ ¼ -->
        <section class="games-grid" id="games-container">
            <!-- æ¸¸æˆå¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
        </section>

        <!-- æœ€è¿‘æ¸¸ç© -->
        <section class="recent-games" id="recent-games" style="display: none;">
            <h2><i class="fas fa-history"></i> æœ€è¿‘æ¸¸ç©</h2>
            <div class="recent-list" id="recent-list"></div>
        </section>

        <!-- é¡µè„š -->
        <footer>
            <div class="footer-content">
                <p>Â© 2025 ç½‘é¡µæ¸¸æˆåˆé›† | ä½¿ç”¨çº¯åŸç”ŸHTMLã€CSSå’ŒJavaScriptå¼€å‘</p>
                <p>æ‰€æœ‰æ¸¸æˆå‡æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡</p>
                <div class="footer-links">
                    <a href="#" id="about-link"><i class="fas fa-info-circle"></i> å…³äº</a>
                    <a href="https://github.com" target="_blank" rel="noopener">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- å…³äºæ¨¡æ€æ¡† -->
    <div class="modal" id="about-modal" role="dialog" aria-labelledby="about-title">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="about-title"><i class="fas fa-info-circle"></i> å…³äºæ¸¸æˆåˆé›†</h2>
                <button class="modal-close" aria-label="å…³é—­">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>è¿™æ˜¯ä¸€ä¸ªçº¯åŸç”ŸJavaScriptå¼€å‘çš„ç½‘é¡µæ¸¸æˆåˆé›†ï¼ŒåŒ…å«10ä¸ªä¸åŒç±»å‹çš„æ¸¸æˆã€‚</p>
                <ul>
                    <li><i class="fas fa-check" style="color: #10b981;"></i> æ— éœ€å®‰è£…ä»»ä½•æ’ä»¶</li>
                    <li><i class="fas fa-check" style="color: #10b981;"></i> æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡</li>
                    <li><i class="fas fa-check" style="color: #10b981;"></i> æš—è‰²/äº®è‰²ä¸»é¢˜åˆ‡æ¢</li>
                    <li><i class="fas fa-check" style="color: #10b981;"></i> æœ¬åœ°å­˜å‚¨æ¸¸æˆè¿›åº¦</li>
                    <li><i class="fas fa-check" style="color: #10b981;"></i> å®Œå…¨å…è´¹å¼€æº</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const games = [
            {
                id: 'space-shooter',
                title: 'å¤ªç©ºå°„å‡»',
                description: 'æ§åˆ¶å¤ªç©ºé£èˆ¹èº²é¿é™¨çŸ³å’Œæ•Œäººï¼Œå‘å°„æ¿€å…‰ä¿å«åœ°çƒ',
                icon: 'fas fa-rocket',
                category: 'action',
                folder: 'space-shooter',
                color: '#00dbde',
                difficulty: 'medium',
                players: 1
            },
            {
                id: 'platform-jumper',
                title: 'å¹³å°è·³è·ƒ',
                description: 'æ§åˆ¶è§’è‰²åœ¨å¹³å°ä¸Šè·³è·ƒï¼Œèº²é¿éšœç¢ï¼Œæ”¶é›†é‡‘å¸',
                icon: 'fas fa-running',
                category: 'action',
                folder: 'platform-jumper',
                color: '#ff6b6b',
                difficulty: 'hard',
                players: 1
            },
            {
                id: 'fruit-2048',
                title: 'æ°´æœ2048',
                description: 'åˆå¹¶ç›¸åŒæ°´æœè¾¾åˆ°2048ï¼Œæ•°å­—æ¸¸æˆçš„ç”œç¾å˜ä½“',
                icon: 'fas fa-apple-alt',
                category: 'puzzle',
                folder: 'fruit-2048',
                color: '#4cd964',
                difficulty: 'medium',
                players: 1
            },
            {
                id: 'memory-cards',
                title: 'è®°å¿†ç¿»ç‰Œ',
                description: 'ç¿»è½¬å¡ç‰‡åŒ¹é…ç›¸åŒå›¾æ¡ˆï¼Œæµ‹è¯•ä½ çš„è®°å¿†åŠ›',
                icon: 'fas fa-brain',
                category: 'puzzle',
                folder: 'memory-cards',
                color: '#ffd166',
                difficulty: 'easy',
                players: 1
            },
            {
                id: 'snake-game',
                title: 'è´ªåƒè›‡',
                description: 'ç»å…¸è´ªåƒè›‡æ¸¸æˆï¼Œæ§åˆ¶è›‡åƒé£Ÿç‰©é•¿å¤§ï¼Œé¿å…æ’å¢™',
                icon: 'fas fa-staff-snake',
                category: 'casual',
                folder: 'snake-game',
                color: '#06d6a0',
                difficulty: 'easy',
                players: 1
            },
            {
                id: 'brick-breaker',
                title: 'æ‰“ç –å—',
                description: 'ç”¨æŒ¡æ¿åå¼¹çƒæ‰“ç¢ç –å—ï¼ŒæŒ‘æˆ˜é«˜åˆ†',
                icon: 'fas fa-table-tennis-paddle-ball',
                category: 'action',
                folder: 'brick-breaker',
                color: '#118ab2',
                difficulty: 'medium',
                players: 1
            },
            {
                id: 'tic-tac-toe',
                title: 'äº•å­—æ£‹AI',
                description: 'ä¸æ™ºèƒ½AIå¯¹æˆ˜äº•å­—æ£‹ï¼Œä½ èƒ½æˆ˜èƒœç”µè„‘å—ï¼Ÿ',
                icon: 'fas fa-xmarks-lines',
                category: 'strategy',
                folder: 'tic-tac-toe',
                color: '#ef476f',
                difficulty: 'easy',
                players: 1
            },
            {
                id: 'minesweeper',
                title: 'æ‰«é›·æ¸¸æˆ',
                description: 'ç»å…¸æ‰«é›·æ¸¸æˆçš„ç½‘é¡µç‰ˆï¼Œå°å¿ƒåœ°é›·ï¼',
                icon: 'fas fa-bomb',
                category: 'strategy',
                folder: 'minesweeper',
                color: '#ff9e00',
                difficulty: 'medium',
                players: 1
            },
            {
                id: 'typing-test',
                title: 'æ‰“å­—é€Ÿåº¦æµ‹è¯•',
                description: 'æµ‹è¯•ä½ çš„æ‰“å­—é€Ÿåº¦å’Œå‡†ç¡®ç‡ï¼Œæå‡é”®ç›˜æŠ€èƒ½',
                icon: 'fas fa-keyboard',
                category: 'casual',
                folder: 'typing-test',
                color: '#9d4edd',
                difficulty: 'easy',
                players: 1
            },
            {
                id: 'physics-pinball',
                title: 'ç‰©ç†å¼¹çƒ',
                description: 'åŸºäºç‰©ç†å¼•æ“çš„å¼¹çƒæ¸¸æˆï¼Œæ§åˆ¶æŒ¡æ¿å¼¹è·³å°çƒ',
                icon: 'fas fa-basketball',
                category: 'action',
                folder: 'physics-pinball',
                color: '#ff9e00',
                difficulty: 'hard',
                players: 1
            }
        ];

        // ç»Ÿè®¡æ•°æ®
        let stats = JSON.parse(localStorage.getItem('gameHubStats')) || {
            totalGamesPlayed: 0,
            totalPlayTime: 0,
            recentlyPlayed: []
        };

        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStats() {
            document.getElementById('games-played').textContent = stats.totalGamesPlayed;
            document.getElementById('play-time').textContent = Math.round(stats.totalPlayTime / 60000);
        }

        // ä¿å­˜ç»Ÿè®¡æ•°æ®
        function saveStats() {
            localStorage.setItem('gameHubStats', JSON.stringify(stats));
        }

        // æ¸²æŸ“æ¸¸æˆå¡ç‰‡
        function renderGames(filteredGames = games) {
            const container = document.getElementById('games-container');
            container.innerHTML = '';

            filteredGames.forEach((game, index) => {
                const card = document.createElement('div');
                card.className = 'game-card';
                card.style.animationDelay = `${index * 50}ms`;
                card.innerHTML = `
                    <div class="game-card-header" style="background: linear-gradient(135deg, ${game.color}22, ${game.color}44);">
                        <div class="game-icon" style="color: ${game.color};">
                            <i class="${game.icon}"></i>
                        </div>
                        <div class="game-badges">
                            <span class="badge badge-difficulty">${getDifficultyText(game.difficulty)}</span>
                        </div>
                    </div>
                    <div class="game-card-body">
                        <h3 class="game-title">${game.title}</h3>
                        <p class="game-description">${game.description}</p>
                        <div class="game-meta">
                            <span class="game-category">
                                <i class="fas fa-tag"></i> ${getCategoryText(game.category)}
                            </span>
                        </div>
                    </div>
                    <div class="game-card-footer">
                        <button class="btn btn-primary play-btn" data-folder="${game.folder}">
                            <i class="fas fa-play"></i> å¼€å§‹æ¸¸æˆ
                        </button>
                    </div>
                `;

                // æ‚¬åœé¢„åŠ è½½
                card.addEventListener('mouseenter', () => {
                    prefetchGame(game.folder);
                });

                // ç‚¹å‡»æŒ‰é’®
                card.querySelector('.play-btn').addEventListener('click', () => {
                    stats.totalGamesPlayed++;
                    stats.recentlyPlayed = stats.recentlyPlayed.filter(g => g !== game.id);
                    stats.recentlyPlayed.unshift(game.id);
                    stats.recentlyPlayed = stats.recentlyPlayed.slice(0, 5);
                    saveStats();
                    updateStats();
                    showSkeletonScreen();
                    window.location.href = `./${game.folder}/`;
                });

                container.appendChild(card);
            });
        }

        // é¢„åŠ è½½æ¸¸æˆé¡µé¢
        function prefetchGame(folder) {
            // æ£€æŸ¥æ˜¯å¦å·²ç»é¢„åŠ è½½
            if (document.querySelector(`link[rel="prefetch"][href*="${folder}"]`)) return;

            const link = document.createElement('link');
            link.rel = 'prefetch';
            link.href = `./${folder}/`;
            document.head.appendChild(link);
        }

        // æ˜¾ç¤ºéª¨æ¶å±
        function showSkeletonScreen() {
            const skeleton = document.createElement('div');
            skeleton.className = 'skeleton-screen';
            skeleton.innerHTML = `
                <div class="skeleton-content">
                    <div class="skeleton-spinner"></div>
                    <p>æ­£åœ¨åŠ è½½æ¸¸æˆ...</p>
                </div>
            `;
            document.body.appendChild(skeleton);

            // 3ç§’åè‡ªåŠ¨ç§»é™¤ï¼ˆé˜²æ­¢é¡µé¢åŠ è½½å¤±è´¥ï¼‰
            setTimeout(() => {
                skeleton.remove();
            }, 3000);
        }

        function getDifficultyText(difficulty) {
            const texts = { easy: 'ç®€å•', medium: 'ä¸­ç­‰', hard: 'å›°éš¾' };
            return texts[difficulty] || difficulty;
        }

        function getCategoryText(category) {
            const texts = { action: 'åŠ¨ä½œ', puzzle: 'ç›Šæ™º', strategy: 'ç­–ç•¥', casual: 'ä¼‘é—²' };
            return texts[category] || category;
        }

        // åˆ†ç±»ç­›é€‰
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const category = btn.dataset.category;
                const filtered = category === 'all' ? games : games.filter(g => g.category === category);
                renderGames(filtered);
            });
        });

        // æœç´¢åŠŸèƒ½
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', () => {
            const query = searchInput.value.toLowerCase();
            const filtered = games.filter(g =>
                g.title.toLowerCase().includes(query) ||
                g.description.toLowerCase().includes(query)
            );
            renderGames(filtered);
        });

        // ä¸»é¢˜åˆ‡æ¢
        const themeToggle = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('gameHub-theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('gameHub-theme', newTheme);
            updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
            themeToggle.querySelector('i').className = theme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
        }

        // å…³äºæ¨¡æ€æ¡†
        const aboutModal = document.getElementById('about-modal');
        const aboutLink = document.getElementById('about-link');
        const closeBtn = aboutModal.querySelector('.modal-close');

        aboutLink.addEventListener('click', (e) => {
            e.preventDefault();
            aboutModal.classList.add('active');
        });

        closeBtn.addEventListener('click', () => {
            aboutModal.classList.remove('active');
        });

        aboutModal.addEventListener('click', (e) => {
            if (e.target === aboutModal) {
                aboutModal.classList.remove('active');
            }
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderGames();
            updateStats();
            initPWAInstall();
        });

        // ==================== PWA å®‰è£…æç¤º ====================
        let deferredPrompt;
        const pwaBanner = document.getElementById('pwa-banner');
        const bannerClose = document.getElementById('banner-close');
        const bannerInstall = document.getElementById('banner-install');

        function initPWAInstall() {
            // æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
            const isInstalled = localStorage.getItem('pwa-installed');
            if (isInstalled) return;

            // æ£€æŸ¥æ˜¯å¦å·²å…³é—­æç¤º
            const dismissedTime = localStorage.getItem('pwa-banner-dismissed');
            if (dismissedTime) {
                const daysSinceDismissed = (Date.now() - parseInt(dismissedTime)) / (1000 * 60 * 60 * 24);
                if (daysSinceDismissed < 7) return; // 7å¤©å†…ä¸å†æ˜¾ç¤º
            }

            // æ£€æµ‹æ˜¯å¦åœ¨ç§»åŠ¨è®¾å¤‡
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            if (!isMobile) return;

            // æ˜¾ç¤ºæ¨ªå¹…
            setTimeout(() => {
                pwaBanner.classList.add('show');
            }, 3000);
        }

        // ç›‘å¬ beforeinstallprompt äº‹ä»¶
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;

            // å»¶è¿Ÿæ˜¾ç¤ºå®‰è£…æ¨ªå¹…
            setTimeout(() => {
                const isInstalled = localStorage.getItem('pwa-installed');
                if (!isInstalled) {
                    pwaBanner.classList.add('show');
                }
            }, 5000);
        });

        // ç›‘å¬åº”ç”¨å®‰è£…æˆåŠŸ
        window.addEventListener('appinstalled', () => {
            localStorage.setItem('pwa-installed', 'true');
            pwaBanner.classList.remove('show');
        });

        // å…³é—­æŒ‰é’®
        bannerClose.addEventListener('click', () => {
            pwaBanner.classList.remove('show');
            localStorage.setItem('pwa-banner-dismissed', Date.now().toString());
        });

        // å®‰è£…æŒ‰é’®
        bannerInstall.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    localStorage.setItem('pwa-installed', 'true');
                }
                deferredPrompt = null;
            } else {
                // iOS æç¤º
                showIOSInstallInstructions();
            }
            pwaBanner.classList.remove('show');
        });

        function showIOSInstallInstructions() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2><i class="fab fa-apple"></i> å®‰è£…åˆ°ä¸»å±å¹•</h2>
                        <button class="modal-close"><span>&times;</span></button>
                    </div>
                    <div class="modal-body">
                        <ol style="line-height: 2;">
                            <li>ç‚¹å‡»åº•éƒ¨çš„ <i class="fab fa-safari" style="color: #00dbde;"></i> Safari åˆ†äº«æŒ‰é’®</li>
                            <li>å‘ä¸‹æ»šåŠ¨å¹¶æ‰¾åˆ°"æ·»åŠ åˆ°ä¸»å±å¹•"</li>
                            <li>ç‚¹å‡»"æ·»åŠ "æŒ‰é’®</li>
                        </ol>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            modal.querySelector('.modal-close').addEventListener('click', () => {
                modal.remove();
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
    </script>
</body>
</html>
