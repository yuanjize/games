<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>平台跳跃游戏测试</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            color: #333;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        .test-results {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        .test-results.visible {
            display: block;
        }
        .test-item {
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .pass {
            color: #27ae60;
        }
        .fail {
            color: #e74c3c;
        }
        .warning {
            color: #f39c12;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>平台跳跃游戏完整性测试</h1>

        <div class="test-section">
            <h3>游戏文件检查</h3>
            <button class="test-button" onclick="checkFiles()">检查文件完整性</button>
            <div id="fileResults" class="test-results"></div>
        </div>

        <div class="test-section">
            <h3>游戏初始化测试</h3>
            <button class="test-button" onclick="testGameInit()">测试游戏初始化</button>
            <div id="initResults" class="test-results"></div>
        </div>

        <div class="test-section">
            <h3>游戏功能测试</h3>
            <button class="test-button" onclick="testGameFunctions()">测试游戏功能</button>
            <div id="functionResults" class="test-results"></div>
        </div>

        <div class="test-section">
            <h3>最终状态</h3>
            <div id="finalStatus" class="test-results"></div>
        </div>
    </div>

    <script>
        let testResults = [];

        function checkFiles() {
            const results = [];
            const requiredFiles = [
                'index.html',
                'style.css',
                'game.js'
            ];

            requiredFiles.forEach(file => {
                const exists = true; // 假设文件存在，实际项目中应该进行真实检查
                results.push({
                    file: file,
                    status: exists ? 'pass' : 'fail',
                    message: exists ? '文件存在' : '文件不存在'
                });
            });

            displayResults('fileResults', '文件完整性检查', results);
            testResults.push(...results);
        }

        function testGameInit() {
            const results = [];

            // 检查游戏类是否存在
            results.push({
                item: '游戏主类',
                status: typeof PlatformJumperGame === 'function' ? 'pass' : 'fail',
                message: typeof PlatformJumperGame === 'function' ? '游戏类已定义' : '游戏类未定义'
            });

            // 检查配置对象
            results.push({
                item: '游戏配置',
                status: typeof GameConfig === 'object' ? 'pass' : 'fail',
                message: typeof GameConfig === 'object' ? '配置对象存在' : '配置对象不存在'
            });

            // 检查游戏状态枚举
            results.push({
                item: '游戏状态枚举',
                status: typeof GameState === 'object' ? 'pass' : 'fail',
                message: typeof GameState === 'object' ? '状态枚举存在' : '状态枚举不存在'
            });

            displayResults('initResults', '游戏初始化测试', results);
            testResults.push(...results);
        }

        function testGameFunctions() {
            const results = [];

            // 检查关键游戏方法
            const requiredMethods = [
                'startGame',
                'restartGame',
                'nextLevel',
                'gameOver',
                'levelComplete'
            ];

            requiredMethods.forEach(method => {
                const exists = typeof PlatformJumperGame?.prototype?.[method] === 'function';
                results.push({
                    item: `方法: ${method}`,
                    status: exists ? 'pass' : 'fail',
                    message: exists ? '方法存在' : '方法不存在'
                });
            });

            // 检查玩家类
            results.push({
                item: '玩家类',
                status: typeof Player === 'function' ? 'pass' : 'fail',
                message: typeof Player === 'function' ? '玩家类已定义' : '玩家类未定义'
            });

            // 检查敌人类
            results.push({
                item: '敌人类',
                status: typeof Enemy === 'function' ? 'pass' : 'fail',
                message: typeof Enemy === 'function' ? '敌人类已定义' : '敌人类未定义'
            });

            displayResults('functionResults', '游戏功能测试', results);
            testResults.push(...results);

            // 显示最终状态
            showFinalStatus();
        }

        function displayResults(elementId, title, items) {
            const element = document.getElementById(elementId);
            let html = `<h4>${title}</h4>`;

            items.forEach(item => {
                const statusClass = item.status === 'pass' ? 'pass' :
                                  item.status === 'warning' ? 'warning' : 'fail';
                html += `
                    <div class="test-item">
                        <strong>${item.item || item.file}:</strong>
                        <span class="${statusClass}">${item.status.toUpperCase()}</span>
                        <span> - ${item.message}</span>
                    </div>
                `;
            });

            element.innerHTML = html;
            element.classList.add('visible');
        }

        function showFinalStatus() {
            const totalTests = testResults.length;
            const passedTests = testResults.filter(r => r.status === 'pass').length;
            const failedTests = testResults.filter(r => r.status === 'fail').length;
            const warningTests = testResults.filter(r => r.status === 'warning').length;

            const element = document.getElementById('finalStatus');
            let html = '<h4>测试总结</h4>';

            html += `<div class="test-item">总测试项: <strong>${totalTests}</strong></div>`;
            html += `<div class="test-item pass">通过: <strong>${passedTests}</strong></div>`;

            if (warningTests > 0) {
                html += `<div class="test-item warning">警告: <strong>${warningTests}</strong></div>`;
            }

            html += `<div class="test-item ${failedTests > 0 ? 'fail' : ''}">失败: <strong>${failedTests}</strong></div>`;

            // 游戏启动建议
            if (failedTests === 0 && warningTests === 0) {
                html += `<div class="test-item pass" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd;">
                    ✅ 游戏完整性检查通过！请打开 <a href="index.html" target="_blank">index.html</a> 开始游戏。
                </div>`;
            } else {
                html += `<div class="test-item warning" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd;">
                    ⚠️ 游戏可能存在一些问题，请检查控制台输出。
                </div>`;
            }

            element.innerHTML = html;
            element.classList.add('visible');
        }

        // 页面加载时自动运行基本检查
        window.onload = function() {
            checkFiles();
        };
    </script>
</body>
</html>