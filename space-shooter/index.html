<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="太空射击游戏 - 一款使用原生JavaScript开发的HTML5 Canvas射击游戏">
    <meta name="keywords" content="太空射击,HTML5游戏,Canvas游戏,JavaScript游戏">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <title>太空射击游戏 | Space Shooter</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Press+Start+2P&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 跳转到主内容链接（可访问性） -->
    <a href="#gameCanvas" class="skip-to-content">跳转到游戏</a>

    <!-- 帮助模态框 -->
    <div id="helpModal" class="help-modal" role="dialog" aria-labelledby="helpModalTitle" aria-modal="true">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h2 id="helpModalTitle" class="help-modal-title">
                    <i class="fas fa-question-circle"></i> 游戏帮助
                </h2>
                <button id="closeHelpModal" class="help-modal-close" aria-label="关闭帮助">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="help-modal-body">
                <div class="instruction-section">
                    <h3><i class="fas fa-keyboard"></i> 键盘快捷键</h3>
                    <ul>
                        <li><kbd class="key">W</kbd><kbd class="key">A</kbd><kbd class="key">S</kbd><kbd class="key">D</kbd> 或方向键 - 移动飞船</li>
                        <li><kbd class="key">空格</kbd> - 发射子弹</li>
                        <li><kbd class="key">P</kbd> - 暂停/继续游戏</li>
                        <li><kbd class="key">ESC</kbd> - 返回菜单</li>
                    </ul>
                </div>
                <div class="instruction-section">
                    <h3><i class="fas fa-hand-pointer"></i> 触摸手势</h3>
                    <ul>
                        <li>虚拟摇杆 - 移动飞船</li>
                        <li>点击发射按钮 - 发射子弹</li>
                        <li>双指轻点 - 暂停游戏</li>
                        <li>长按任意位置 - 显示帮助</li>
                    </ul>
                </div>
                <div class="instruction-section">
                    <h3><i class="fas fa-trophy"></i> 游戏提示</h3>
                    <ul>
                        <li>难度越高，分数倍率越高</li>
                        <li>保持移动，避免停留在同一位置</li>
                        <li>集中火力击毁敌机获得更多分数</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="game-container">
        <!-- 游戏标题 -->
        <header class="game-header">
            <a href="../index.html" class="back-button" aria-label="返回游戏大厅">
                <i class="fas fa-arrow-left"></i> 返回游戏大厅
            </a>
            <h1 class="game-title">
                <i class="fas fa-rocket"></i>
                太空射击
                <span class="game-subtitle">Space Shooter</span>
            </h1>
            <div class="header-actions">
                <div class="version-tag">v2.0</div>
                <button id="themeToggle" class="theme-toggle" aria-label="切换主题" title="切换亮色/暗色主题">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="highContrastToggle" class="high-contrast-toggle" aria-label="切换高对比度模式" aria-pressed="false" title="切换高对比度模式">
                    <i class="fas fa-adjust"></i>
                </button>
            </div>
        </header>

        <!-- 游戏主画布 -->
        <div class="canvas-wrapper">
            <!-- 加载动画 -->
            <div id="loadingOverlay" class="loading-overlay">
                <div class="loading-spinner"></div>
                <div class="loading-progress">
                    <div id="loadingProgressBar" class="loading-progress-bar"></div>
                </div>
                <div class="loading-text">
                    加载中... <span id="loadingPercentage" class="loading-percentage">0%</span>
                </div>
            </div>

            <canvas id="gameCanvas"
                    role="application"
                    aria-label="太空射击游戏区域"
                    aria-live="polite"
                    aria-describedby="gameInstructions">
                您的浏览器不支持Canvas，请使用现代浏览器访问。
            </canvas>

            <!-- 游戏状态叠加层 -->
            <div id="gameOverlay" class="game-overlay">
                <!-- 开始屏幕 -->
                <div id="startScreen" class="screen start-screen">
                    <div class="screen-content">
                        <div class="screen-title">
                            <i class="fas fa-play-circle"></i>
                            开始游戏
                        </div>

                        <div class="controls-info">
                            <div class="control-group">
                                <h3><i class="fas fa-keyboard"></i> 键盘控制</h3>
                                <div class="control-item">
                                    <span class="key"><i class="fas fa-arrows-alt"></i></span>
                                    <span class="control-desc">方向键/WASD 移动飞船</span>
                                </div>
                                <div class="control-item">
                                    <span class="key">空格</span>
                                    <span class="control-desc">发射子弹</span>
                                </div>
                                <div class="control-item">
                                    <span class="key">P</span>
                                    <span class="control-desc">暂停/继续</span>
                                </div>
                                <div class="control-item">
                                    <span class="key">ESC</span>
                                    <span class="control-desc">返回菜单</span>
                                </div>
                            </div>

                            <div class="control-group">
                                <h3><i class="fas fa-mobile-alt"></i> 触摸控制</h3>
                                <div class="control-item">
                                    <span class="key"><i class="fas fa-hand-point-up"></i></span>
                                    <span class="control-desc">虚拟摇杆移动</span>
                                </div>
                                <div class="control-item">
                                    <span class="key"><i class="fas fa-crosshairs"></i></span>
                                    <span class="control-desc">点击发射子弹</span>
                                </div>
                            </div>
                        </div>

                        <div class="game-objects-preview">
                            <h3><i class="fas fa-gamepad"></i> 游戏元素</h3>
                            <div class="preview-grid">
                                <div class="preview-item">
                                    <div class="preview-ship"></div>
                                    <span>玩家飞船</span>
                                </div>
                                <div class="preview-item">
                                    <div class="preview-enemy"></div>
                                    <span>敌机 (-1生命)</span>
                                </div>
                                <div class="preview-item">
                                    <div class="preview-asteroid"></div>
                                    <span>陨石 (-1生命)</span>
                                </div>
                                <div class="preview-item">
                                    <div class="preview-bullet"></div>
                                    <span>子弹 (+10分)</span>
                                </div>
                            </div>
                        </div>

                        <div class="difficulty-selector">
                            <h3><i class="fas fa-tachometer-alt"></i> 游戏难度</h3>
                            <div class="difficulty-buttons">
                                <button class="difficulty-btn active" data-difficulty="easy" aria-label="选择简单难度">
                                    <i class="fas fa-star"></i> 简单
                                </button>
                                <button class="difficulty-btn" data-difficulty="medium" aria-label="选择中等难度">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i> 中等
                                </button>
                                <button class="difficulty-btn" data-difficulty="hard" aria-label="选择困难难度">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i> 困难
                                </button>
                            </div>
                        </div>

                        <button id="startGameBtn" class="primary-btn" aria-label="开始游戏">
                            <i class="fas fa-play"></i> 开始游戏
                        </button>

                        <div class="hint-text">
                            <i class="fas fa-lightbulb"></i> 提示：难度越高，分数越多！
                        </div>
                    </div>
                </div>

                <!-- 暂停屏幕 -->
                <div id="pauseScreen" class="screen pause-screen" style="display: none;">
                    <div class="screen-content">
                        <div class="screen-title">
                            <i class="fas fa-pause-circle"></i>
                            游戏暂停
                        </div>
                        <div class="pause-stats">
                            <div class="stat-item">
                                <i class="fas fa-trophy"></i>
                                <span>得分: <span id="pauseScore">0</span></span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-heart"></i>
                                <span>生命: <span id="pauseLives">3</span></span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-clock"></i>
                                <span>时间: <span id="pauseTime">0</span>秒</span>
                            </div>
                        </div>
                        <button id="resumeGameBtn" class="primary-btn" aria-label="继续游戏">
                            <i class="fas fa-play"></i> 继续游戏
                        </button>
                        <button id="restartGameBtn" class="secondary-btn" aria-label="重新开始游戏">
                            <i class="fas fa-redo"></i> 重新开始
                        </button>
                    </div>
                </div>

                <!-- 游戏结束屏幕 -->
                <div id="gameOverScreen" class="screen game-over-screen" style="display: none;">
                    <div class="screen-content">
                        <div class="screen-title">
                            <i class="fas fa-skull-crossbones"></i>
                            游戏结束
                        </div>

                        <div class="final-stats">
                            <div class="final-stat">
                                <i class="fas fa-trophy"></i>
                                <h4>最终得分</h4>
                                <div class="stat-value" id="finalScore">0</div>
                            </div>
                            <div class="final-stat">
                                <i class="fas fa-clock"></i>
                                <h4>生存时间</h4>
                                <div class="stat-value" id="finalTime">0<span>秒</span></div>
                            </div>
                            <div class="final-stat">
                                <i class="fas fa-crosshairs"></i>
                                <h4>击毁敌机</h4>
                                <div class="stat-value" id="finalEnemies">0</div>
                            </div>
                        </div>

                        <div class="high-score" id="highScoreContainer" style="display: none;">
                            <div class="high-score-badge">
                                <i class="fas fa-crown"></i>
                                <span>新纪录!</span>
                            </div>
                            <div class="high-score-text">
                                恭喜你创造了新的最高分！
                            </div>
                        </div>

                        <div class="restart-options">
                            <button id="playAgainBtn" class="primary-btn" aria-label="再玩一次">
                                <i class="fas fa-redo"></i> 再玩一次
                            </button>
                            <button id="backToMenuBtn" class="secondary-btn" aria-label="返回主菜单">
                                <i class="fas fa-home"></i> 返回菜单
                            </button>
                        </div>

                        <div class="share-game">
                            <h4><i class="fas fa-share-alt"></i> 分享成绩</h4>
                            <div class="share-buttons">
                                <button class="share-btn" data-platform="twitter" aria-label="分享到Twitter">
                                    <i class="fab fa-twitter"></i>
                                </button>
                                <button class="share-btn" data-platform="facebook" aria-label="分享到Facebook">
                                    <i class="fab fa-facebook"></i>
                                </button>
                                <button class="share-btn" data-platform="weibo" aria-label="分享到微博">
                                    <i class="fab fa-weibo"></i>
                                </button>
                                <button class="share-btn" data-platform="copy" aria-label="复制链接">
                                    <i class="fas fa-link"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 游戏HUD (始终显示) -->
            <div class="game-hud">
                <div class="hud-left">
                    <div class="hud-item">
                        <i class="fas fa-trophy"></i>
                        <span>得分: <span id="scoreDisplay">0</span></span>
                    </div>
                    <div class="hud-item">
                        <i class="fas fa-heart"></i>
                        <span>生命: <span id="livesDisplay">3</span></span>
                        <div class="hearts-container">
                            <div class="heart active"></div>
                            <div class="heart active"></div>
                            <div class="heart active"></div>
                        </div>
                    </div>
                </div>

                <div class="hud-right">
                    <div class="hud-item">
                        <i class="fas fa-clock"></i>
                        <span>时间: <span id="timeDisplay">0</span>秒</span>
                    </div>
                    <div class="hud-item">
                        <i class="fas fa-crosshairs"></i>
                        <span>击毁: <span id="enemiesDisplay">0</span></span>
                    </div>
                    <div class="hud-item">
                        <i class="fas fa-bolt"></i>
                        <span>火力: <span id="fireRateDisplay">标准</span></span>
                    </div>
                </div>

                <button id="pauseBtn" class="pause-button" aria-label="暂停游戏">
                    <i class="fas fa-pause"></i>
                </button>
            </div>

            <!-- 触摸控制区域（仅移动设备显示） -->
            <div class="touch-controls" aria-label="触摸控制区域">
                <div class="touch-joystick" id="joystickArea" role="region" aria-label="虚拟摇杆控制">
                    <div class="joystick-center"></div>
                </div>
                <div class="touch-shoot" id="shootButton" role="button" aria-label="发射子弹">
                    <i class="fas fa-crosshairs"></i>
                    <span>发射</span>
                </div>
            </div>
        </div>

        <!-- 游戏说明 -->
        <div class="game-instructions">
            <div class="instructions-toggle" id="instructionsToggle" aria-expanded="false" aria-controls="gameInstructions">
                <i class="fas fa-info-circle"></i>
                <span>游戏说明</span>
                <i class="fas fa-chevron-down toggle-icon"></i>
            </div>
            <div class="instructions-content" id="gameInstructions" aria-labelledby="instructionsToggle">
                <div class="instruction-section">
                    <h3><i class="fas fa-bullseye"></i> 游戏目标</h3>
                    <p>控制你的太空飞船，躲避敌机，同时发射子弹击毁敌机获得分数。尽可能长时间生存并获得高分！</p>
                </div>
                <div class="instruction-section">
                    <h3><i class="fas fa-exclamation-triangle"></i> 注意事项</h3>
                    <ul>
                        <li>被敌机撞击会损失1点生命值</li>
                        <li>初始有3点生命值，生命值耗尽游戏结束</li>
                        <li>击毁一架敌机获得10分</li>
                        <li>不同难度下敌机速度和数量不同</li>
                    </ul>
                </div>
                <div class="instruction-section">
                    <h3><i class="fas fa-trophy"></i> 高分策略</h3>
                    <ul>
                        <li>选择高难度可获得更高分数</li>
                        <li>保持移动，避免停留在同一位置</li>
                        <li>集中火力击毁敌机</li>
                        <li>利用屏幕边缘进行战术移动</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 游戏统计 -->
        <div class="game-stats">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalGamesPlayed">0</div>
                        <div class="stat-label">游戏次数</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="bestScore">0</div>
                        <div class="stat-label">最高分</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="bestTime">0<span>秒</span></div>
                        <div class="stat-label">最长生存</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-crosshairs"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalEnemiesDestroyed">0</div>
                        <div class="stat-label">击毁敌机</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 游戏音效控制 -->
        <div class="audio-controls">
            <button id="toggleSoundBtn" class="audio-btn active" aria-label="音效开关，当前为开启状态">
                <i class="fas fa-volume-up"></i>
                <span>音效: 开启</span>
            </button>
            <button id="toggleMusicBtn" class="audio-btn" aria-label="背景音乐开关，当前为关闭状态">
                <i class="fas fa-music"></i>
                <span>音乐: 关闭</span>
            </button>
        </div>

        <!-- 游戏页脚 -->
        <footer class="game-footer">
            <div class="footer-content">
                <p>© 2024 太空射击游戏 | 使用原生JavaScript开发</p>
                <div class="footer-links">
                    <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="footer-link">
                        <i class="fab fa-github"></i> 查看源代码
                    </a>
                    <a href="#" class="footer-link" id="reportBug">
                        <i class="fas fa-bug"></i> 报告问题
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- 音频元素 -->
    <audio id="shootSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-laser-weapon-shot-1671.mp3" type="audio/mpeg">
    </audio>
    <audio id="explosionSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-bomb-explosion-2800.mp3" type="audio/mpeg">
    </audio>
    <audio id="hitSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3" type="audio/mpeg">
    </audio>
    <audio id="gameOverSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-retro-arcade-game-over-470.mp3" type="audio/mpeg">
    </audio>
    <audio id="bgMusic" loop preload="auto">
        <source src="https://assets.mixkit.co/music/preview/mixkit-game-show-suspense-waiting-667.mp3" type="audio/mpeg">
    </audio>

    <script src="game.js"></script>
</body>
</html>
